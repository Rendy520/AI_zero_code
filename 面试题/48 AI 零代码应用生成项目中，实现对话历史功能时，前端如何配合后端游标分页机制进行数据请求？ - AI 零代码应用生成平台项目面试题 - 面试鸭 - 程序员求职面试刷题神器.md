
# AI 零代码应用生成项目中，实现对话历史功能时，前端如何配合后端游标分页机制进行数据请求？

前端通过维护一个游标状态，并将其作为请求参数，来配合后端的游标分页机制，实现高效的对话历史加载。

1）前端在组件的状态中维护一个名为 `lastCreateTime` 的变量，它存储当前消息列表中最老一条消息的创建时间。这个变量就是前端的游标。

2）当用户进入对话页面时，前端会首次调用对话历史接口，此时不传递 `lastCreateTime` 参数。后端接收到没有游标的请求后，会查询并返回最新的一页数据。

3）前端接收到数据后，会将列表中最后一条消息的 `createTime` 赋值给 `lastCreateTime` 变量，为下一次加载做准备。

4）当用户触发加载更多历史消息时，前端会再次调用同一个接口，但这次会在请求参数中带上当前存储的 `lastCreateTime` 值。

5）后端根据传入的 `lastCreateTime` 参数，在数据库查询中加入条件，只拉取比该时间更早的数据，避免数据重复和偏移量查询的性能问题。

6）前端收到返回的旧消息列表后，会将这些消息通过 `unshift` 方法添加到现有消息数组的 最前面，以保证整个对话列表按时间顺序正确显示。
