
# 什么是 AI 智能路由？你如何利用 AI 根据用户需求自动选择最合适的代码生成方案？

AI 智能路由是一种利用大模型进行决策，根据用户输入自动选择最合适处理流程的机制。在本项目中，我用它来解决一个核心问题：当用户提出需求时，系统应该自动判断是使用原生 HTML、原生多文件还是 Vue 工程这三种方案中的哪一种来生成应用。

![](https://pic.code-nav.cn/mianshiya/question_picture/markdown/KCKfc3MT_202508221359297_mianshiya.png)

我的实现方案主要基于 LangChain4j 的结构化输出能力：

1）我编写了一个专门的系统提示词 `codegen-routing-system-prompt.txt`。这个提示词赋予 AI “代码生成方案路由器” 的角色，并明确列出了可选的方案以及详细的判断规则。比如：

-   如果用户需求简单，只需要一个展示页面，选择 HTML
-   如果用户需求复杂，涉及多页面、复杂交互、数据管理等，选择 VUE\_PROJECT

2）我定义了一个 `AiCodeGenTypeRoutingService` 接口，其核心方法 `routeCodeGenType` 的返回值直接就是 `CodeGenTypeEnum` 这个枚举类型。通过 LangChain4j 的结构化输出机制，AI 的决策结果会被自动转换为对应的枚举值，无需手动解析字符串。

3）在用户创建应用的 `createApp` 业务方法中，我会调用这个智能路由服务。将用户的初始 `initPrompt` 作为输入，获取 AI 推荐的 `CodeGenTypeEnum`，然后将这个结果存入数据库的 `app` 表中。后续的代码生成流程就会根据这个类型来执行相应的逻辑。

4）此外，由于路由决策是一个相对简单的分类任务，我为这个功能配置了成本更低、响应更快的轻量级大模型，在保证决策质量的同时优化了系统的整体成本和性能。

通过这种方式，系统实现了智能化的流程选择，不仅提升用户体验，还为不同复杂度的任务匹配了最合适的处理资源。
